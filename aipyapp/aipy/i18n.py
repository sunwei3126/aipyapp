#!/usr/bin/env python
# -*- coding: utf-8 -*-

import locale
import os
import ctypes
import platform

MESSAGES = {
    'zh': {
        'start_instruction': 'å¼€å§‹å¤„ç†æŒ‡ä»¤',
        'start_execute': 'å¼€å§‹æ‰§è¡Œä»£ç å—',
        'execute_result': 'æ‰§è¡Œç»“æœ',
        'start_feedback': 'å¼€å§‹åé¦ˆç»“æœ',
        'end_instruction': 'ç»“æŸå¤„ç†æŒ‡ä»¤',
        'no_context': 'æœªæ‰¾åˆ°ä¸Šä¸‹æ–‡ä¿¡æ¯',
        'sync_to_cloud': 'æ­£åœ¨ä¸Šä¼ ç»“æœï¼Œè¯·ç¨å...',
        'upload_success': 'ä¸Šä¼ æˆåŠŸï¼Œç§å¯†ä¿å­˜åœ°å€ï¼š{}',
        'upload_failed': 'ä¸Šä¼ å¤±è´¥ (çŠ¶æ€ç : {})',
        'reset_warning': 'ä¸¥é‡è­¦å‘Šï¼šè¿™å°†é‡æ–°åˆå§‹åŒ–â—â—â—',
        'reset_confirm': 'å¦‚æœä½ ç¡®å®šè¦ç»§ç»­ï¼Œè¯·è¾“å…¥ y',
        'llm_response': 'å“åº”',
        'env_description': 'ç¯å¢ƒå˜é‡åç§°å’Œæ„ä¹‰',
        'description': 'æè¿°',
        'unknown_format': 'ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼',
        'ask_for_packages': 'ç”³è¯·å®‰è£…ç¬¬ä¸‰æ–¹åŒ…',
        'agree_packages': 'å¦‚æœåŒæ„ï¼Œè¯·è¾“å…¥',
        'ask_for_env': 'ç”³è¯·è·å–ç¯å¢ƒå˜é‡ {}ï¼Œç”¨é€”',
        'env_exist': 'ç¯å¢ƒå˜é‡ {} å­˜åœ¨ï¼Œè¿”å›ç»™ä»£ç ä½¿ç”¨',
        'input_env': 'æœªæ‰¾åˆ°ç¯å¢ƒå˜é‡ {}ï¼Œè¯·è¾“å…¥',
        'call_failed': 'è°ƒç”¨å¤±è´¥',
        'think': 'æ€è€ƒ',
        'publish_disabled': "å½“å‰ç¯å¢ƒä¸æ”¯æŒå‘å¸ƒ",
        'auto_confirm': 'è‡ªåŠ¨ç¡®è®¤',
        'packages_exist': 'ç”³è¯·çš„ç¬¬ä¸‰æ–¹åŒ…å·²ç»å®‰è£…',
        'thinking': 'æ­£åœ¨ç»å°½è„‘æ±æ€è€ƒä¸­ï¼Œè¯·ç¨ç­‰6-60ç§’',
        'no_available_llm': 'æ²¡æœ‰å¯ç”¨çš„ LLMï¼Œè¯·æ£€æŸ¥é…ç½®æ–‡ä»¶',
        'banner1_python': "è¯·ç”¨ ai('ä»»åŠ¡') è¾“å…¥éœ€è¦ AI å¤„ç†çš„ä»»åŠ¡ (è¾“å…¥ ai.use(llm) åˆ‡æ¢ä¸‹è¿° LLMï¼š",
        'banner1': "è¯·è¾“å…¥éœ€è¦ AI å¤„ç†çš„ä»»åŠ¡ (è¾“å…¥ /use <ä¸‹è¿° LLM> åˆ‡æ¢ï¼Œè¾“å…¥ /info æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯)",
        'default': 'é»˜è®¤',
        'enabled': 'å·²å¯ç”¨',
        'ai_mode_enter': 'è¿›å…¥ AI æ¨¡å¼ï¼Œå¼€å§‹å¤„ç†ä»»åŠ¡ï¼Œè¾“å…¥ Ctrl+d æˆ– /done ç»“æŸä»»åŠ¡',
        'ai_mode_exit': "[é€€å‡º AI æ¨¡å¼]",
        'ai_mode_unknown_command': "[AI æ¨¡å¼] æœªçŸ¥å‘½ä»¤",
        'Task Summary': 'ä»»åŠ¡æ€»ç»“',
        'Round': 'è½®æ¬¡',
        'Time(s)': 'æ—¶é—´(ç§’)',
        'In Tokens': 'è¾“å…¥ä»¤ç‰Œæ•°',
        'Out Tokens': 'è¾“å‡ºä»¤ç‰Œæ•°',
        'Total Tokens': 'æ€»ä»¤ç‰Œæ•°',
        'sending_task': 'æ­£åœ¨å‘ {} ä¸‹è¾¾ä»»åŠ¡',
        'error_loading_config': "åŠ è½½é…ç½®æ—¶å‡ºé”™: {}",
        'config_file_error': "è¯·æ£€æŸ¥é…ç½®æ–‡ä»¶è·¯å¾„å’Œæ ¼å¼ã€‚",
        'config_not_loaded': "é…ç½®å°šæœªåŠ è½½ã€‚",
        'llm_config_not_found': "ç¼ºå°‘ 'llm' é…ç½®ã€‚",
        'not usable': "ä¸å¯ç”¨",
        'permission_denied_error': "æ— æƒé™åˆ›å»ºç›®å½•: {}",
        'error_creating_config_dir': "åˆ›å»ºé…ç½®ç›®å½•æ—¶å‡ºé”™: {}",
        'migrate_config': "æˆåŠŸçš„å°†æ—§ç‰ˆæœ¬trustokené…ç½®è¿ç§»åˆ° {}",
        'migrate_user_config': "æˆåŠŸçš„å°†æ—§ç‰ˆæœ¬ç”¨æˆ·é…ç½®è¿ç§»åˆ° {}",
        'binding_request_sent': "ç»‘å®šè¯·æ±‚å‘é€æˆåŠŸã€‚\nè¯·æ±‚ID: {}\n\n>>> è¯·åœ¨å·²è®¤è¯è®¾å¤‡çš„æµè§ˆå™¨ä¸­æ‰“å¼€ä»¥ä¸‹é“¾æ¥ä»¥æ‰¹å‡†:\n>>> {}\n\n(è¯¥é“¾æ¥å°†åœ¨{}ç§’åè¿‡æœŸ)",
        'scan_qr_code': "æˆ–è€…æ‰«æä¸‹æ–¹äºŒç»´ç ï¼š",
        'config_help': "æ¨èæ‚¨æ‰‹æœºæ‰«ç ç»‘å®šAiPyå¤§è„‘ï¼Œæ‚¨ä¹Ÿå¯ä»¥é…ç½®ç¬¬ä¸‰æ–¹å¤§æ¨¡å‹å¤§è„‘ï¼Œè¯¦æƒ…å‚è€ƒï¼šhttps://d.aipy.app/d/77",
        'qr_code_display_failed': "(æ— æ³•æ˜¾ç¤ºäºŒç»´ç : {})\n",
        'coordinator_request_error': "è¿æ¥åˆ°åè°ƒæœåŠ¡å™¨æˆ–è¯·æ±‚æ—¶å‡ºé”™: {}",
        'unexpected_request_error': "è¯·æ±‚è¿‡ç¨‹ä¸­å‘ç”Ÿæ„å¤–é”™è¯¯: {}",
        'waiting_for_approval': "æµè§ˆå™¨å·²æ‰“å¼€Trustokenç½‘ç«™ï¼Œè¯·æ³¨å†Œæˆ–ç™»å½•æˆæƒ",
        'current_status': "å½“å‰çŠ¶æ€: {}...",
        'binding_expired': "\nç»‘å®šè¯·æ±‚å·²è¿‡æœŸã€‚",
        'unknown_status': "\næ”¶åˆ°æœªçŸ¥çŠ¶æ€: {}",
        'coordinator_polling_error': "è½®è¯¢åè°ƒæœåŠ¡å™¨æ—¶å‡ºé”™: {}",
        'unexpected_polling_error': "è½®è¯¢è¿‡ç¨‹ä¸­å‘ç”Ÿæ„å¤–é”™è¯¯: {}",
        'polling_cancelled': "\nç”¨æˆ·å–æ¶ˆäº†è½®è¯¢ã€‚",
        'polling_timeout': "\nè½®è¯¢è¶…æ—¶ã€‚",
        'start_binding_process': "å½“å‰ç¯å¢ƒç¼ºå°‘å¿…éœ€çš„é…ç½®æ–‡ä»¶ï¼Œå¼€å§‹è¿›è¡Œé…ç½®åˆå§‹åŒ–æµç¨‹ï¼Œä¸trustokenè´¦å·ç»‘å®šå³å¯è‡ªåŠ¨è·å–é…ç½®...",
        'binding_success': "\nç»‘å®šæµç¨‹å·²æˆåŠŸå®Œæˆã€‚",
        'binding_failed': "\nç»‘å®šæµç¨‹å¤±è´¥æˆ–æœªå®Œæˆã€‚",
        'binding_request_failed': "\nç»‘å®šè¯·æ±‚å‘èµ·å¤±è´¥ã€‚",
        'cancel': "å–æ¶ˆ",
        'trust_token_auth': "TrustToken è®¤è¯",
        'Error': "é”™è¯¯",
        'Time remaining': "å‰©ä½™æ—¶é—´ï¼š{} ç§’",
        'approved': "å·²æ‰¹å‡†",
        'expired': "å·²è¿‡æœŸ",
        'pending': "å¾…å¤„ç†",
        'unknown_status': "æ”¶åˆ°æœªçŸ¥çŠ¶æ€: {}",
        'attempting_migration': 'å‘ç°æ—§çš„é…ç½®æ–‡ä»¶: {}\nå°è¯•ä»è¿™äº›æ–‡ä»¶è¿ç§»é…ç½®...\nè¿ç§»ä¹‹åï¼Œè¿™äº›æ–‡ä»¶ä¼šè¢«å¤‡ä»½åˆ° {}ï¼Œè¯·æ³¨æ„æŸ¥çœ‹ã€‚',
        'task_saved': 'ç»“æœæ–‡ä»¶å·²ä¿å­˜',
        'env_info': 'å½“å‰é…ç½®æ–‡ä»¶ç›®å½•ï¼š{} å·¥ä½œç›®å½•: {}',
        'sys_info': 'ç³»ç»Ÿä¿¡æ¯',
        'Save chat history as HTML': 'ä¿å­˜èŠå¤©è®°å½•ä¸º HTML',
        'Clear chat': 'æ¸…ç©ºèŠå¤©',
        'Exit': 'é€€å‡º',
        'Start new task': 'å¼€å§‹æ–°ä»»åŠ¡',
        'Website': 'å®˜ç½‘',
        'Forum': 'è®ºå›',
        'WeChat Group': 'å¾®ä¿¡ç¾¤',
        'About': 'å…³äº',
        'Help': 'å¸®åŠ©',
        'File': 'æ–‡ä»¶',
        'Edit': 'ç¼–è¾‘',
        'Task': 'ä»»åŠ¡',
        'Current task has ended': 'å½“å‰ä»»åŠ¡å·²ç»“æŸ',
        'Operation in progress, please wait...': 'æ“ä½œè¿›è¡Œä¸­ï¼Œè¯·ç¨å€™...',
        'Operation completed. If you want to start the next task, please click the "End" button': 'æ“ä½œå®Œæˆã€‚å¦‚æœå¼€å§‹ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œè¯·ç‚¹å‡»"ç»“æŸ"æŒ‰é’®',
        'Press Ctrl+Enter to send message': 'æŒ‰ Ctrl+Enter å‘é€æ¶ˆæ¯',
        'Save chat history as HTML file': 'ä¿å­˜èŠå¤©è®°å½•ä¸º HTML æ–‡ä»¶',
        'Exit program': 'é€€å‡ºç¨‹åº',
        'Clear all messages': 'æ¸…é™¤æ‰€æœ‰æ¶ˆæ¯',
        'Start a new task': 'å¼€å§‹ä¸€ä¸ªæ–°ä»»åŠ¡',
        'Official website': 'å®˜æ–¹ç½‘ç«™',
        'Official forum': 'å®˜æ–¹è®ºå›',
        'Official WeChat group': 'å®˜æ–¹å¾®ä¿¡ç¾¤',
        'About AIPY': 'å…³äºçˆ±æ´¾',
        'Configuration': 'é…ç½®',
        'Configure program parameters': 'é…ç½®ç¨‹åºå‚æ•°',
        'Work Directory': 'å·¥ä½œç›®å½•',
        'Browse...': 'æµè§ˆ...',
        'Select work directory': 'é€‰æ‹©å·¥ä½œç›®å½•',
        'Max Tokens': 'æœ€å¤§Tokenæ•°',
        'Timeout (seconds)': 'è¶…æ—¶æ—¶é—´(ç§’)',
        'Max Rounds': 'æœ€å¤§æ‰§è¡Œè½®æ•°',
        'OK': 'ç¡®å®š',
        'Cancel': 'å–æ¶ˆ',
        'AIPY is an intelligent assistant that can help you complete various tasks.': 'çˆ±æ´¾æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œå¯ä»¥å¸®åŠ©æ‚¨å®Œæˆå„ç§ä»»åŠ¡ã€‚',
        'Current configuration directory': 'å½“å‰é…ç½®ç›®å½•',
        'Current working directory': 'å½“å‰å·¥ä½œç›®å½•',
        'Version': 'ç‰ˆæœ¬',
        'AIPY Team': 'çˆ±æ´¾å›¢é˜Ÿ',
        'You can create a new directory in the file dialog': 'æ‚¨å¯ä»¥åœ¨æ–‡ä»¶å¯¹è¯æ¡†ä¸­é€‰æ‹©æˆ–åˆ›å»ºæ–°ç›®å½•',
        'Settings': 'è®¾ç½®',
        'Open work directory': 'æ‰“å¼€å·¥ä½œç›®å½•',
        'Open work directory in file manager': 'åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­æ‰“å¼€å·¥ä½œç›®å½•',
        'requesting_binding': 'æ­£åœ¨ç”³è¯·ç»‘å®š',
        'Update available': 'å‘ç°æ–°ç‰ˆæœ¬',
        "tt_base_url": "https://api.trustoken.cn/v1",
        "tt_coordinator_url": "https://www.trustoken.cn/api",
        'Work directory does not exist': 'å·¥ä½œç›®å½•ä¸å­˜åœ¨',
        'Warning': 'è­¦å‘Š',
        'LLM {} is not available': 'LLM {} ä¸å¯ç”¨',
        'End': 'ç»“æŸ',
        'Send': 'å‘é€',
        'AIPY - Your AI Assistant': 'ğŸ™çˆ±æ´¾ï¼Œæ‚¨çš„å¹²æ´»ç‰›ğŸ‚é©¬ğŸï¼Œå•¥éƒ½èƒ½å¹²ï¼',
        'API Market': 'API å¸‚åœº',
        'LLM Configuration': 'LLM é…ç½®',
        'Provider Configuration': 'æä¾›å•†é…ç½®',
        'Me': 'æˆ‘',
        'Turing': 'å›¾çµ',
        'AIPy': 'çˆ±æ´¾',
        'Current task': 'å½“å‰ä»»åŠ¡',
        'End processing instruction': 'ç»“æŸå¤„ç†æŒ‡ä»¤',
        'Run result': 'è¿è¡Œç»“æœ',
        'Update available': 'å‘ç°æ–°ç‰ˆæœ¬',
        'Failed to save file': 'æ— æ³•ä¿å­˜æ–‡ä»¶',
        'Operation in progress, please wait...': 'æ“ä½œè¿›è¡Œä¸­ï¼Œè¯·ç¨å€™...',
        'Operation completed. If you start a new task, please click the "End" button': 'æ“ä½œå®Œæˆã€‚å¦‚æœå¼€å§‹ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œè¯·ç‚¹å‡»"ç»“æŸ"æŒ‰é’®',
        'Press Ctrl+Enter to send message': 'æŒ‰ Ctrl/Cmd+Enter å‘é€æ¶ˆæ¯',
        'welcome_message': 'å“ˆå•°ï¼æˆ‘æ˜¯**çˆ±æ´¾**ï¼Œæ‚¨çš„æ™ºèƒ½ä»»åŠ¡å°ç®¡å®¶!\nè¯·å…è®¸æˆ‘éš†é‡ä»‹ç»å›¢é˜Ÿå…¶å®ƒæˆå‘˜ï¼š\n- å›¾çµï¼šå®‡å®™æœ€å¼ºäººå·¥æ™ºèƒ½ï¼Œå¤æ‚ä»»åŠ¡åˆ†æå’Œè§„åˆ’\n- BB-8: å®‡å®™æœ€å¼ºæœºå™¨äººï¼Œè´Ÿè´£æ‰§è¡Œä»»åŠ¡\n\næ¸©é¦¨æç¤ºï¼šæ‰“å¼€èœå•æ "**å¸®åŠ©**"é“¾æ¥ï¼Œå¯ä»¥è”ç³»**çˆ±æ´¾**å®˜æ–¹å’ŒåŠ å…¥ç¾¤èŠã€‚',
        'Select LLM Provider': 'é€‰æ‹© LLM æä¾›å•†',
        'Provider': 'æä¾›å•†',
        'Trustoken': 'Trustoken',
        'Other': 'å…¶å®ƒ',
        'Trustoken is an intelligent API Key management service': 'Trustoken æ˜¯ä¸€ä¸ªæ™ºèƒ½çš„ API Key ç®¡ç†æœåŠ¡',
        'Auto get and manage API Key': 'è‡ªåŠ¨è·å–å’Œç®¡ç† API Key',
        'Support multiple LLM providers': 'æ”¯æŒå¤šä¸ª LLM æä¾›å•†',
        'Auto select optimal model': 'è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜æ¨¡å‹',
        'Recommended for beginners, easy to configure and feature-rich': 'å»ºè®®å°ç™½ç”¨æˆ·é€‰æ‹©ï¼Œé…ç½®æ–¹ä¾¿ã€åŠŸèƒ½ä¸°å¯Œ',
        'Select other providers requires manual configuration': 'é€‰æ‹©å…¶å®ƒæä¾›å•†éœ€è¦æ‰‹åŠ¨é…ç½®',
        'Need to apply for API Key yourself': 'éœ€è¦è‡ªè¡Œç”³è¯· API Key',
        'Manually input API Key': 'æ‰‹åŠ¨è¾“å…¥ API Key',
        'Manually select model': 'æ‰‹åŠ¨é€‰æ‹©æ¨¡å‹',
        'Trustoken Configuration': 'Trustoken é…ç½®',
        'API Key': 'API Key',
        'Auto open browser to get API Key': 'è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨è·å– API Key',
        'Current status': 'å½“å‰çŠ¶æ€',
        'Binding expired': 'ç»‘å®šå·²è¿‡æœŸ',
        'Unknown status': 'æœªçŸ¥çŠ¶æ€',
        'Waiting timeout': 'ç­‰å¾…è¶…æ—¶',
        'API Key obtained successfully': 'API Key è·å–æˆåŠŸï¼',
        'API Key acquisition failed, please try again': 'API Key è·å–å¤±è´¥ï¼Œè¯·é‡è¯•',
        'Requesting binding': 'æ­£åœ¨ç”³è¯·ç»‘å®š',
        'Waiting for user confirmation': 'ç­‰å¾…ç”¨æˆ·ç¡®è®¤',
        'Remaining time': 'å‰©ä½™æ—¶é—´',
        'seconds': 'ç§’',
        'You can also click this link to open browser to get API Key': 'ä½ ä¹Ÿå¯ä»¥ç‚¹å‡»æ­¤é“¾æ¥æ‰“å¼€æµè§ˆå™¨è·å–API Key',
        'Please get API Key first': 'è¯·å…ˆè·å–API Key',
        'Available Models': 'å¯ç”¨æ¨¡å‹',
        'Temperature (%)': 'æ¸©åº¦',
        'Please select provider and input API Key, click Next to verify': 'è¯·é€‰æ‹©æä¾›å•†å¹¶è¾“å…¥API Keyï¼Œç‚¹å‡»ä¸‹ä¸€æ­¥éªŒè¯',
        'Please select model to use and configure parameters': 'è¯·é€‰æ‹©è¦ä½¿ç”¨çš„æ¨¡å‹å¹¶é…ç½®å‚æ•°',
        'Model list acquisition failed': 'æ— æ³•è·å–æ¨¡å‹åˆ—è¡¨ï¼Œè¯·æ£€æŸ¥ API Key æ˜¯å¦æ­£ç¡®',
        'Hint': 'æç¤º',
        'API Name': 'APIåç§°',
        'Delete': 'åˆ é™¤',
        'Confirm Delete': 'ç¡®è®¤åˆ é™¤',
        'Are you sure to delete API': 'ç¡®å®šè¦åˆ é™¤API',
        'Add API': 'æ–°å¢API',
        'Edit API': 'ç¼–è¾‘API',
        'API Key Settings': 'APIå¯†é’¥è®¾ç½®',
        'Add Environment Variable': 'æ·»åŠ ç¯å¢ƒå˜é‡',
        'API Description': 'APIæè¿°',
        'API Description Hint': 'æç¤º: æè¿°æ”¯æŒå¤šè¡Œæ–‡æœ¬ï¼Œå°†ä»¥"""..."""æ ¼å¼ä¿å­˜',
        'Save': 'ä¿å­˜',
        'Variable Name': 'å˜é‡å',
        'Value': 'å€¼',
        'Remove': 'ç§»é™¤',
        'Add': 'æ·»åŠ ',
        'Refresh': 'åˆ·æ–°',
        'No API configured': 'æœªé…ç½®ä»»ä½•API',
        'API Details': 'APIè¯¦æƒ…',
        'Close': 'å…³é—­',
        'API configuration saved': 'APIé…ç½®å·²ä¿å­˜',
        'Failed to save API configuration': 'ä¿å­˜APIé…ç½®å¤±è´¥',
        'API configuration loaded': 'APIé…ç½®å·²åŠ è½½',
        'Failed to load API configuration': 'åŠ è½½APIé…ç½®å¤±è´¥',
        'API deleted': 'APIå·²åˆ é™¤',
        'Failed to delete API': 'åˆ é™¤APIå¤±è´¥',
        'API added': 'APIå·²æ·»åŠ ',
        'Failed to add API': 'æ·»åŠ APIå¤±è´¥',
        'API updated': 'APIå·²æ›´æ–°',
        'Failed to update API': 'æ›´æ–°APIå¤±è´¥',
        'Support multiline text': 'æ”¯æŒå¤šè¡Œæ–‡æœ¬',
        'You can only add two environment variables at most': 'æœ€å¤šåªèƒ½æ·»åŠ ä¸¤ä¸ªç¯å¢ƒå˜é‡',
        'API Market - Manage Your API Configurations': 'APIå¸‚åœº - ç®¡ç†æ‚¨çš„APIé…ç½®',
        'Manage your API configurations here, including adding new APIs, viewing and editing existing ones.': 'åœ¨æ­¤å¤„ç®¡ç†æ‚¨çš„APIé…ç½®ï¼ŒåŒ…æ‹¬æ·»åŠ æ–°APIã€æŸ¥çœ‹å’Œç¼–è¾‘ç°æœ‰APIã€‚',
        'Add New API': 'æ·»åŠ æ–°API',
        'Refresh List': 'åˆ·æ–°åˆ—è¡¨',
        'Number of Keys': 'å¯†é’¥æ•°é‡',
        'Description': 'æè¿°',
        'Tip: Right-click on API item to view, edit and delete': 'æç¤º: å³é”®ç‚¹å‡»APIé¡¹å¯è¿›è¡ŒæŸ¥çœ‹ã€ç¼–è¾‘å’Œåˆ é™¤æ“ä½œ',
        'No API configured': 'æš‚æ— APIé…ç½®',
        'Click "Add New API" button to add API configuration': 'ç‚¹å‡»"æ·»åŠ æ–°API"æŒ‰é’®æ·»åŠ APIé…ç½®',
        'View Details': 'æŸ¥çœ‹è¯¦æƒ…',
        'API name cannot be empty': 'APIåç§°ä¸èƒ½ä¸ºç©º',
        'API name already exists': 'APIåç§°å·²å­˜åœ¨',
        'API configuration saved and applied': 'APIé…ç½®å·²ä¿å­˜å¹¶åº”ç”¨',
        'Failed to save configuration': 'ä¿å­˜é…ç½®å¤±è´¥',
        'Error': 'é”™è¯¯',
        'Success': 'æˆåŠŸ',
        'API Details': 'APIè¯¦æƒ…',
        'Environment Variables': 'ç¯å¢ƒå˜é‡',
        'Variable Name': 'å˜é‡å',
        'Value': 'å€¼',
        'API Description': 'APIæè¿°',
        'Support multiline text': 'æ”¯æŒå¤šè¡Œæ–‡æœ¬',
        'API Description Hint': 'æç¤º: æè¿°æ”¯æŒå¤šè¡Œæ–‡æœ¬ï¼Œå°†ä»¥"""..."""æ ¼å¼ä¿å­˜',
        'API Key Settings': 'APIå¯†é’¥è®¾ç½®',
        'Add Environment Variable': 'æ·»åŠ ç¯å¢ƒå˜é‡',
        'Enter your API key': 'å¡«å†™æ‚¨çš„APIå¯†é’¥',
        'API key description': 'APIå¯†é’¥æè¿°',
        'You can only add two environment variables at most': 'æœ€å¤šåªèƒ½æ·»åŠ ä¸¤ä¸ªç¯å¢ƒå˜é‡',
        'Hint': 'æç¤º',
        'Save and Apply': 'ä¿å­˜å¹¶åº”ç”¨',
        'Cancel': 'å–æ¶ˆ',
        'Close': 'å…³é—­',
        'Edit': 'ç¼–è¾‘',
        'Delete': 'åˆ é™¤',
        'Remove': 'ç§»é™¤',
        'Are you sure to delete API': 'ç¡®å®šè¦åˆ é™¤API',
        'Confirm Delete': 'ç¡®è®¤åˆ é™¤',
        'Select other providers': 'è¯·é€‰æ‹©å…¶å®ƒæä¾›å•†',
        'Model list acquisition failed': 'æ— æ³•è·å–æ¨¡å‹åˆ—è¡¨ï¼Œè¯·æ£€æŸ¥ API Key æ˜¯å¦æ­£ç¡®',
        'Available Models': 'è¯·é€‰æ‹©æ¨¡å‹',
        'Max Tokens': 'è¯·è¾“å…¥æœ€å¤§ Token æ•°ï¼ˆé»˜è®¤ï¼š8192ï¼‰',
        'Temperature (%)': 'è¯·è¾“å…¥ Temperatureï¼ˆ0-1ï¼Œé»˜è®¤ï¼š0.7ï¼‰',
        'Click here for more information': 'ç‚¹å‡»è¿™é‡Œè·å–æ›´å¤šä¿¡æ¯',
        'LLM Provider Configuration Wizard': 'LLM æä¾›å•†é…ç½®å‘å¯¼',
        'Select Model': 'è¯·é€‰æ‹©æ¨¡å‹',
        'Trustoken uses automatic model selection': 'Trustoken ä½¿ç”¨è‡ªåŠ¨æ¨¡å‹é€‰æ‹©',
        'Configuration saved': 'é…ç½®å·²ä¿å­˜',
        'Failed to save configuration': 'ä¿å­˜é…ç½®å¤±è´¥',
        'Configuration loaded': 'é…ç½®å·²åŠ è½½',
        'Failed to load configuration': 'åŠ è½½é…ç½®å¤±è´¥',
        'Configuration applied': 'é…ç½®å·²åº”ç”¨',
        'Failed to apply configuration': 'åº”ç”¨é…ç½®å¤±è´¥',
        'Starting LLM Provider Configuration Wizard': 'æœªæ‰¾åˆ° LLM é…ç½®ï¼Œå¼€å§‹é…ç½® LLM æä¾›å•†',
        'User cancelled configuration': 'ç”¨æˆ·å–æ¶ˆé…ç½®',
        "https://aipy.app": "https://www.aipyaipy.com",
        "https://d.aipy.app": "https://d.aipyaipy.com",
        "https://d.aipy.app/d/13": "https://d.aipyaipy.com/d/13",
    },
    'en': {
        'start_instruction': 'Start processing instruction',
        'start_execute': 'Start executing code block',
        'execute_result': 'Execution result',
        'start_feedback': 'Start sending feedback',
        'end_instruction': 'End processing instruction',
        'no_context': 'No context information found',
        'sync_to_cloud': 'Uploading result, please wait...',
        'upload_success': 'Article uploaded successfully',
        'upload_failed': 'Upload failed (status code: {})',
        'reset_warning': 'Severe warning: This will reinitializeâ—â—â—',
        'reset_confirm': 'If you are sure to continue, enter y',
        'llm_response': 'reply',
        'env_description': 'Environment variable name and meaning',
        'description': 'Description',
        'unknown_format': 'Unsupported file format',
        'ask_for_packages': 'Request to install third-party packages',
        'agree_packages': 'If you agree, please enter',
        'ask_for_env': 'Request to obtain environment variable {}, purpose',
        'env_exist': 'Environment variable {} exists, returned for code use',
        'input_env': 'Environment variable {} not found, please enter',
        'call_failed': 'Call failed',
        'think': 'Think',
        'publish_disabled': "Current environment does not support publishing",
        'auto_confirm': 'Auto confirm',
        'packages_exist': 'Third-party packages have been installed',
        'thinking': 'is thinking hard, please wait 6-60 seconds',
        'no_available_llm': 'No available LLM, please check the configuration file',
        'banner1_python': "Please use ai('task') to enter the task to be processed by AI (enter ai.use(llm) to switch to the following LLM:",
        'banner1': "Please enter the task to be processed by AI (enter /use <following LLM> to switch, enter /info to view system information)",
        'default': 'Default',
        'enabled': 'Enabled',
        'ai_mode_enter': 'Enter AI mode, start processing tasks, enter Ctrl+d or /done to end the task',
        'ai_mode_exit': "[Exit AI mode]",
        'ai_mode_unknown_command': "[AI mode] Unknown command",
        'Task Summary': 'Task Summary',
        'Round': 'Round',
        'Time(s)': 'Time(s)',
        'In Tokens': 'In Tokens',
        'Out Tokens': 'Out Tokens',
        'Total Tokens': 'Total Tokens',
        'sending_task': 'Sending task to {}',
        'error_loading_config': "Error loading configuration: {}",
        'config_file_error': "Please check the configuration file path and format.",
        'config_not_loaded': "Configuration not loaded.",
        'llm_config_not_found': "Missing 'llm' configuration.",
        'not usable': "Not usable",
        'permission_denied_error': "Permission denied to create directory: {}",
        'error_creating_config_dir': "Error creating configuration directory: {}",
        'migrate_config': "Successfully migrated old version trustoken configuration to {}",
        'migrate_user_config': "Successfully migrated old version user configuration to {}",
        'binding_request_sent': "Binding request sent successfully.\nRequest ID: {}\n\n>>> Please open this URL in your browser on an authenticated device to approve:\n>>> {}\n\n(This link expires in {} seconds)",
        'scan_qr_code': "Or scan the QR code below:",
        'config_help': "We recommend you scan the QR code to bind the AiPy brain, you can also configure a third-party large model brain, details refer to: https://d.aipy.app/d/77",
        'qr_code_display_failed': "(Could not display QR code: {})\n",
        'coordinator_request_error': "Error connecting to coordinator or during request: {}",
        'unexpected_request_error': "An unexpected error occurred during request: {}",
        'waiting_for_approval': "Browser has opened the Trustoken website, please register or login to authorize",
        'current_status': "Current status: {}...",
        'binding_expired': "\nBinding request expired.",
        'unknown_status': "\nUnknown status received: {}",
        'coordinator_polling_error': "Error connecting to coordinator during polling: {}",
        'unexpected_polling_error': "An unexpected error occurred during polling: {}",
        'polling_cancelled': "\nPolling cancelled by user.",
        'polling_timeout': "\nPolling timed out.",
        'start_binding_process': "The current environment lacks the required configuration file. Starting the configuration initialization process to bind with the Trustoken account...",
        'binding_success': "\nBinding process completed successfully.",
        'binding_failed': "\nBinding process failed or was not completed.",
        'binding_request_failed': "\nFailed to initiate binding request.",
        'cancel': "Cancel",
        'trust_token_auth': "TrustToken Authentication",
        'Error': "Error",
        'Time remaining': "Time remaining: {} seconds",
        'approved': "Approved",
        'expired': "Expired",
        'pending': "Pending",
        'unknown_status': "Received unknown status: {}",
        'attempting_migration': 'Found old configuration files: {}\nAttempting to migrate configuration from these files...\nAfter migration, these files will be backed up to {}, please check them.',
        'task_saved': 'Result file saved',
        'env_info': 'Current configuration file directory: {} Working directory: {}',
        'sys_info': 'System information',
        'Save chat history as HTML': 'Save chat history as HTML',
        'Clear chat': 'Clear chat',
        'Exit': 'Exit',
        'Start new task': 'Start new task',
        'Website': 'Website',
        'Forum': 'Forum',
        'WeChat Group': 'WeChat Group',
        'About': 'About',
        'Help': 'Help',
        'File': 'File',
        'Edit': 'Edit',
        'Task': 'Task',
        'Current task has ended': 'Current task has ended',
        'Operation in progress, please wait...': 'Operation in progress, please wait...',
        'Operation completed. If you want to start the next task, please click the "End" button': 'Operation completed. If you want to start the next task, please click the "End" button',
        'Press Ctrl+Enter to send message': 'Press Ctrl+Enter to send message',
        'Save chat history as HTML file': 'Save chat history as HTML file',
        'Exit program': 'Exit program',
        'Clear all messages': 'Clear all messages',
        'Start a new task': 'Start a new task',
        'Official website': 'Official website',
        'Official forum': 'Official forum',
        'Official WeChat group': 'Official WeChat group',
        'About AIPY': 'About AIPY',
        'Configuration': 'Configuration',
        'Configure program parameters': 'Configure program parameters',
        'Work Directory': 'Work Directory',
        'Browse...': 'Browse...',
        'Select work directory': 'Select work directory',
        'Max Tokens': 'Max Tokens',
        'Timeout (seconds)': 'Timeout (seconds)',
        'Max Rounds': 'Max Rounds',
        'OK': 'OK',
        'Cancel': 'Cancel',
        'AIPY is an intelligent assistant that can help you complete various tasks.': 'AIPY is an intelligent assistant that can help you complete various tasks.',
        'Current configuration directory': 'Current configuration directory',
        'Current working directory': 'Current working directory',
        'Version': 'Version',
        'AIPY Team': 'AIPY Team',
        'You can create a new directory in the file dialog': 'You can create a new directory in the file dialog',
        'Settings': 'Settings',
        "tt_base_url": "https://sapi.trustoken.ai/v1",
        "tt_coordinator_url": "https://www.trustoken.ai/api",
        'Work directory does not exist': 'Work directory does not exist',
        'Warning': 'Warning',
        'LLM {} is not available': 'LLM {} is not available',
        'End': 'End',
        'Send': 'Send',
        'AIPY - Your AI Assistant': 'ğŸ™ AIPY - Your AI Assistant ğŸ‚ ğŸ',
        'API Market': 'API Market',
        'LLM Configuration': 'LLM Configuration',
        'Provider Configuration': 'Provider Configuration',
        'Me': 'Me',
        'Turing': 'Turing',
        'AIPy': 'AIPy',
        'Current task': 'Current task',
        'End processing instruction': 'End processing instruction',
        'Run result': 'Run result',
        'Update available': 'Update available',
        'Failed to save file': 'Failed to save file',
        'Operation in progress, please wait...': 'Operation in progress, please wait...',
        'Operation completed. If you start a new task, please click the "End" button': 'Operation completed. If you start a new task, please click the "End" button',
        'Press Ctrl+Enter to send message': 'Press Ctrl/Cmd+Enter to send message',
        'welcome_message': 'Hello! I am **AIPy**, your intelligent task assistant!\nPlease allow me to introduce the other members of the team:\n- Turing: The strongest artificial intelligence, complex task analysis and planning\n- BB-8: The strongest robot, responsible for executing tasks\n\nNote: Click the "**Help**" link in the menu bar to contact the **AIPy** official and join the group chat.',
        'Select LLM Provider': 'Select LLM Provider',
        'Provider': 'Provider',
        'Trustoken': 'Trustoken',
        'Other': 'Other',
        'Trustoken is an intelligent API Key management service': 'Trustoken is an intelligent API Key management service',
        'Auto get and manage API Key': 'Auto get and manage API Key',
        'Support multiple LLM providers': 'Support multiple LLM providers',
        'Auto select optimal model': 'Auto select optimal model',
        'Recommended for beginners, easy to configure and feature-rich': 'Recommended for beginners, easy to configure and feature-rich',
        'Select other providers requires manual configuration': 'Select other providers requires manual configuration',
        'Need to apply for API Key yourself': 'Need to apply for API Key yourself',
        'Manually input API Key': 'Manually input API Key',
        'Manually select model': 'Manually select model',
        'Trustoken Configuration': 'Trustoken Configuration',
        'API Key': 'API Key',
        'Auto open browser to get API Key': 'Auto open browser to get API Key',
        'Current status': 'Current status',
        'Binding expired': 'Binding expired',
        'Unknown status': 'Unknown status',
        'Waiting timeout': 'Waiting timeout',
        'API Key obtained successfully': 'API Key obtained successfully!',
        'API Key acquisition failed, please try again': 'API Key acquisition failed, please try again',
        'Requesting binding': 'Requesting binding',
        'Waiting for user confirmation': 'Waiting for user confirmation',
        'Remaining time': 'Remaining time',
        'seconds': 'seconds',
        'You can also click this link to open browser to get API Key': 'You can also click this link to open browser to get API Key',
        'Please get API Key first': 'Please get API Key first',
        'Available Models': 'Available Models',
        'Temperature (%)': 'Temperature (%)',
        'Please select provider and input API Key, click Next to verify': 'Please select provider and input API Key, click Next to verify',
        'Please select model to use and configure parameters': 'Please select model to use and configure parameters',
        'Model list acquisition failed': 'Model list acquisition failed',
        'Hint': 'Hint',
        'API Name': 'API Name',
        'Delete': 'Delete',
        'Confirm Delete': 'Confirm Delete',
        'Are you sure to delete API': 'Are you sure to delete API',
        'Add API': 'Add API',
        'Edit API': 'Edit API',
        'API Key Settings': 'API Key Settings',
        'Add Environment Variable': 'Add Environment Variable',
        'API Description': 'API Description',
        'API Description Hint': 'Hint: Description supports multi-line text, will be saved in """...""" format',
        'Save': 'Save',
        'Variable Name': 'Variable Name',
        'Value': 'Value',
        'Remove': 'Remove',
        'Add': 'Add',
        'Refresh': 'Refresh',
        'No API configured': 'No API configured',
        'API Details': 'API Details',
        'Close': 'Close',
        'API configuration saved': 'API configuration saved',
        'Failed to save API configuration': 'Failed to save API configuration',
        'API configuration loaded': 'API configuration loaded',
        'Failed to load API configuration': 'Failed to load API configuration',
        'API deleted': 'API deleted',
        'Failed to delete API': 'Failed to delete API',
        'API added': 'API added',
        'Failed to add API': 'Failed to add API',
        'API updated': 'API updated',
        'Failed to update API': 'Failed to update API',
        'Support multiline text': 'Support multiline text',
        'You can only add two environment variables at most': 'You can only add two environment variables at most',
        'API Market - Manage Your API Configurations': 'API Market - Manage Your API Configurations',
        'Manage your API configurations here, including adding new APIs, viewing and editing existing ones.': 'Manage your API configurations here, including adding new APIs, viewing and editing existing ones.',
        'Add New API': 'Add New API',
        'Refresh List': 'Refresh List',
        'Number of Keys': 'Number of Keys',
        'Description': 'Description',
        'Tip: Right-click on API item to view, edit and delete': 'Tip: Right-click on API item to view, edit and delete',
        'No API configured': 'No API configured',
        'Click "Add New API" button to add API configuration': 'Click "Add New API" button to add API configuration',
        'View Details': 'View Details',
        'API name cannot be empty': 'API name cannot be empty',
        'API name already exists': 'API name already exists',
        'API configuration saved and applied': 'API configuration saved and applied',
        'Failed to save configuration': 'Failed to save configuration',
        'Error': 'Error',
        'Success': 'Success',
        'API Details': 'API Details',
        'Environment Variables': 'Environment Variables',
        'Variable Name': 'Variable Name',
        'Value': 'Value',
        'API Description': 'API Description',
        'Support multiline text': 'Support multiline text',
        'API Description Hint': 'Hint: Description supports multi-line text, will be saved in """...""" format',
        'API Key Settings': 'API Key Settings',
        'Add Environment Variable': 'Add Environment Variable',
        'Enter your API key': 'Enter your API key',
        'API key description': 'API key description',
        'You can only add two environment variables at most': 'You can only add two environment variables at most',
        'Hint': 'Hint',
        'Save and Apply': 'Save and Apply',
        'Cancel': 'Cancel',
        'Close': 'Close',
        'Edit': 'Edit',
        'Delete': 'Delete',
        'Remove': 'Remove',
        'Are you sure to delete API': 'Are you sure to delete API',
        'Confirm Delete': 'Confirm Delete',
        'Click here for more information': 'Click here for more information',
        'LLM Provider Configuration Wizard': 'LLM Provider Configuration Wizard',
        'Select Model': 'Select Model',
        'Trustoken uses automatic model selection': 'Trustoken uses automatic model selection',
        'Configuration saved': 'Configuration saved',
        'Failed to save configuration': 'Failed to save configuration',
        'Configuration loaded': 'Configuration loaded',
        'Failed to load configuration': 'Failed to load configuration',
        'Configuration applied': 'Configuration applied',
        'Failed to apply configuration': 'Failed to apply configuration',
        'Select other providers': 'Select other providers',
        'Starting LLM Provider Configuration Wizard': 'Starting LLM Provider Configuration Wizard',
        'User cancelled configuration': 'User cancelled configuration',
        "https://aipy.app": "https://aipy.app",
        "https://d.aipy.app": "https://d.aipy.app",
        "https://d.aipy.app/d/13": "https://d.aipy.app/d/13",        
    }
}

__lang__ = 'en'

def get_lang():
    return __lang__

def set_lang(lang=None):
    global __lang__, MESSAGES
    if lang and lang in MESSAGES:
        __lang__ = lang
        return
    
    language, _ = locale.getlocale()
    if language:
        language = language.lower()
        if language.find('china') >=0 or language.find('chinese') >= 0 or language.find('zh_') >= 0:
            __lang__ = 'zh'

def T(key, *args):
    msg = MESSAGES[__lang__][key]
    return msg.format(*args) if args else msg

def get_system_language() -> str:
    """
    è·å–å½“å‰è¿è¡Œç¯å¢ƒçš„è¯­è¨€ä»£ç  (ä¾‹å¦‚ 'en', 'zh')ã€‚
    æ”¯æŒ Windows, macOS, Linuxã€‚
    è¿”å›å°å†™çš„è¯­è¨€ä»£ç ï¼Œå¦‚æœæ— æ³•ç¡®å®šåˆ™è¿”å› 'en'ã€‚
    """
    language_code = 'en' # é»˜è®¤è‹±è¯­

    try:
        if platform.system() == "Windows":
            # Windows: ä½¿ç”¨ GetUserDefaultUILanguage æˆ– GetSystemDefaultUILanguage
            # https://learn.microsoft.com/en-us/windows/win32/intl/language-identifiers
            windll = ctypes.windll.kernel32
            # GetUserDefaultUILanguage è¿”å›å½“å‰ç”¨æˆ·çš„UIè¯­è¨€ID
            lang_id = windll.GetUserDefaultUILanguage()
            # å°†è¯­è¨€IDè½¬æ¢ä¸ºæ ‡å‡†è¯­è¨€ä»£ç  (ä¾‹å¦‚ 1033 -> en, 2052 -> zh)
            # ä¸»è¦è¯­è¨€IDåœ¨ä½10ä½
            primary_lang_id = lang_id & 0x3FF
            if primary_lang_id == 0x04: # zh - Chinese
                language_code = 'zh'
            elif primary_lang_id == 0x09: # en - English
                language_code = 'en'
            # å¯ä»¥æ ¹æ®éœ€è¦æ·»åŠ æ›´å¤šè¯­è¨€IDæ˜ å°„
            # å‚è€ƒ: https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-lcid/a9eac961-e77d-41a6-90a5-ce1a8b0cdb9c

        elif platform.system() == "Darwin": # macOS
            # macOS: ä¼˜å…ˆä½¿ç”¨ locale.getlocale()
            language, encoding = locale.getlocale()
            if language:
                language_code = language.split('_')[0].lower()
            else:
                # å¤‡é€‰æ–¹æ¡ˆ: è¯»å–ç¯å¢ƒå˜é‡
                lang_env = os.environ.get('LANG')
                if lang_env:
                    language_code = lang_env.split('_')[0].lower()

        else: # Linux/Unix
            # Linux/Unix: ä¼˜å…ˆä½¿ç”¨ locale.getlocale()
            language, encoding = locale.getlocale()
            if language:
                language_code = language.split('_')[0].lower()
            else:
                # å¤‡é€‰æ–¹æ¡ˆ: è¯»å–ç¯å¢ƒå˜é‡ LANG æˆ– LANGUAGE
                lang_env = os.environ.get('LANG') or os.environ.get('LANGUAGE')
                if lang_env:
                    language_code = lang_env.split('_')[0].lower()

        # è§„èŒƒåŒ–å¸¸è§çš„ä¸­æ–‡ä»£ç 
        if language_code.startswith('zh'):
            language_code = 'zh'

    except Exception:
        # å¦‚æœå‘ç”Ÿä»»ä½•é”™è¯¯ï¼Œå›é€€åˆ°é»˜è®¤å€¼ 'en'
        pass # ä½¿ç”¨é»˜è®¤çš„ 'en'

    return language_code

set_lang()
